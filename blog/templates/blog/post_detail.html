{% extends "blog/base.html" %}
{% load static %}

{% block extra_head %}
    {{ block.super }}
    <style>
        /* CKEditor5 Content Styles */
        .post-content {
            font-family: Arial, Helvetica, sans-serif;
            line-height: 1.6;
            color: #333;
        }

        /* Headings */
        .post-content h1,
        .post-content .ck-heading_heading1 {
            font-size: 2.25rem; /* 36px */
            font-weight: bold;
            margin: 1.5rem 0 1rem;
            color: #1a202c; /* gray-900 */
        }

        .post-content h2,
        .post-content .ck-heading_heading2 {
            font-size: 1.875rem; /* 30px */
            font-weight: bold;
            margin: 1.25rem 0 0.75rem;
            color: #1a202c;
        }

        .post-content h3,
        .post-content .ck-heading_heading3 {
            font-size: 1.5rem; /* 24px */
            font-weight: bold;
            margin: 1rem 0 0.5rem;
            color: #1a202c;
        }

        .post-content p,
        .post-content .ck-heading_paragraph {
            font-size: 1rem; /* 16px */
            margin-bottom: 1rem;
        }

        /* Blockquote */
        .post-content blockquote {
            border-left: 4px solid #3182ce; /* blue-600 */
            padding-left: 1rem;
            margin: 1.5rem 0;
            font-style: italic;
            color: #4a5568; /* gray-700 */
            background: #edf2f7; /* gray-100 */
            padding: 1rem;
        }

        /* Lists */
        .post-content ul {
            list-style-type: disc;
            padding-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .post-content ol {
            list-style-type: decimal;
            padding-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .post-content li {
            margin-bottom: 0.5rem;
        }

        /* Images */
        .post-content img {
            max-width: 100%;
            height: auto;
            margin: 1rem 0;
            border-radius: 0.375rem; /* rounded-lg */
        }

        .post-content .image-style-align-left {
            float: left;
            margin-right: 1.5rem;
            margin-bottom: 1rem;
        }

        .post-content .image-style-align-right {
            float: right;
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }

        .post-content .image-style-align-center {
            display: block;
            margin-left: auto;
            margin-right: auto;
        }

        .post-content .image-style-side {
            float: right;
            margin-left: 1.5rem;
            max-width: 50%;
        }

        /* Tables */
        .post-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 1.5rem 0;
        }

        .post-content table th,
        .post-content table td {
            border: 1px solid #e2e8f0; /* gray-200 */
            padding: 0.75rem;
            text-align: left;
        }

        .post-content table th {
            background-color: #edf2f7; /* gray-100 */
            font-weight: bold;
        }

        /* Table properties with custom color palette */
        .post-content table[style*="border-color: hsl(4, 90%, 58%)"],
        .post-content td[style*="border-color: hsl(4, 90%, 58%)"],
        .post-content th[style*="border-color: hsl(4, 90%, 58%)"] {
            border-color: hsl(4, 90%, 58%); /* Red from customColorPalette */
        }

        .post-content table[style*="background-color: hsl(4, 90%, 58%)"],
        .post-content td[style*="background-color: hsl(4, 90%, 58%)"],
        .post-content th[style*="background-color: hsl(4, 90%, 58%)"] {
            background-color: hsl(4, 90%, 58%);
            color: white;
        }

        /* Inline styles */
        .post-content strong {
            font-weight: bold;
        }

        .post-content em {
            font-style: italic;
        }

        .post-content a {
            color: #3182ce; /* blue-600 */
            text-decoration: underline;
            transition: color 0.2s;
        }

        .post-content a:hover {
            color: #2b6cb0; /* blue-700 */
        }

        .post-content code {
            background-color: #f7fafc; /* gray-50 */
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-family: monospace;
        }

        .post-content pre {
            background-color: #1a202c; /* gray-900 */
            color: #edf2f7; /* gray-100 */
            padding: 1rem;
            border-radius: 0.375rem;
            overflow-x: auto;
            margin: 1.5rem 0;
        }

        .post-content sub {
            vertical-align: sub;
            font-size: 0.75rem;
        }

        .post-content sup {
            vertical-align: super;
            font-size: 0.75rem;
        }

        .post-content mark {
            background-color: #fefcbf; /* yellow-100 */
            padding: 0.2rem;
        }

        /* Font styles */
        .post-content [style*="font-size"] {
            font-size: inherit; /* Let CKEditor inline styles take precedence */
        }

        .post-content [style*="font-family"] {
            font-family: inherit; /* Let CKEditor inline styles take precedence */
        }

        .post-content [style*="color"] {
            color: inherit; /* Let CKEditor inline styles take precedence */
        }

        .post-content [style*="background-color"] {
            background-color: inherit; /* Let CKEditor inline styles take precedence */
        }

        /* Dark mode adjustments */
        @media (prefers-color-scheme: dark) {
            .post-content {
                color: #e2e8f0; /* gray-200 */
            }

            .post-content h1,
            .post-content h2,
            .post-content h3 {
                color: #ffffff; /* white */
            }

            .post-content blockquote {
                border-left-color: #63b3ed; /* blue-400 */
                background: #2d3748; /* gray-800 */
                color: #cbd5e0; /* gray-400 */
            }

            .post-content table th,
            .post-content table td {
                border-color: #4a5568; /* gray-700 */
            }

            .post-content table th {
                background-color: #2d3748; /* gray-800 */
            }

            .post-content code {
                background-color: #2d3748; /* gray-800 */
            }

            .post-content pre {
                background-color: #1a202c; /* gray-900 */
                color: #e2e8f0; /* gray-200 */
            }

            .post-content mark {
                background-color: #744210; /* yellow-800 */
            }
        }
    </style>
{% endblock %}

{% block content %}
<!-- Breadcrumb and Title Section -->
<div class="mt-6 px-4 sm:px-6 lg:px-8">
    <nav class="text-sm text-gray-600 dark:text-gray-400 mb-4" aria-label="Breadcrumb">
        <ol class="list-reset flex space-x-2">
            <li>
                <a href="{% url 'category_detail' slug=post.category.slug %}"
                    class="text-blue-600 hover:underline dark:text-blue-400">
                    {{ post.category.title }}
                </a>
            </li>
        </ol>
    </nav>

    <h1 class="text-2xl sm:text-3xl font-bold text-gray-900 dark:text-white mb-2">
        {{ post.title }}
    </h1>

    <p class="text-sm text-gray-700 dark:text-gray-300">
        Â· {{ post.created_at|date:"F j, Y" }}
    </p>

    <!-- Featured Image -->
    <div class="mt-6 px-4 sm:px-6 lg:px-8">
        <img src="{{ post.image.url }}" alt="{{ post.title }} image"
            class="w-full max-w-4xl mx-auto rounded-lg shadow-md object-contain">
    </div>

    <!-- Post Content -->
    <div class="mt-10 max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 text-gray-800 dark:text-gray-200 post-content">
        {{ post.content|safe }} <!-- Wrap content in post-content class -->
    </div>

    <!-- Share Options -->
    <div class="mt-10 border-t pt-6">
        <h3 class="text-lg font-semibold mb-4 text-gray-900 dark:text-white">Share This Post</h3>
        <div class="flex flex-wrap gap-6">
            <!-- Facebook -->
            <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank"
                rel="noopener noreferrer"
                class="flex flex-col items-center space-y-1 text-center text-gray-600 dark:text-gray-300 hover:text-[#1877F2] dark:hover:text-[#1877F2]">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M22.675 0H1.325C.593 0 0 .593 0 1.325v21.351C0 23.407.593 24 1.325 24H12.82v-9.294H9.692v-3.622h3.128V8.413c0-3.1 1.893-4.788 4.659-4.788 1.325 0 2.463.099 2.795.143v3.24l-1.918.001c-1.504 0-1.795.715-1.795 1.763v2.313h3.587l-.467 3.622h-3.12V24h6.116c.732 0 1.325-.593 1.325-1.325V1.325C24 .593 23.407 0 22.675 0z" />
                </svg>
                <span class="text-xs">Facebook</span>
            </a>

            <!-- Twitter -->
            <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}" target="_blank"
                rel="noopener noreferrer"
                class="flex flex-col items-center space-y-1 text-center text-gray-600 dark:text-gray-300 hover:text-[#1DA1F2] dark:hover:text-[#1DA1F2]">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482A13.87 13.87 0 011.671 3.149a4.922 4.922 0 001.523 6.574 4.903 4.903 0 01-2.229-.616v.061a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 14-7.496 14-14V5.649a9.872 9.872 0 002.488-2.429z" />
                </svg>
                <span class="text-xs">Twitter</span>
            </a>

            <!-- LinkedIn -->
            <a href="https://www.linkedin.com/shareArticle?mini=true&url={{ request.build_absolute_uri }}"
                target="_blank" rel="noopener noreferrer"
                class="flex flex-col items-center space-y-1 text-center text-gray-600 dark:text-gray-300 hover:text-[#0A66C2] dark:hover:text-[#0A66C2]">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 448 512">
                    <path
                        d="M100.28 448H7.4V148.9h92.88zm-46.44-340.7C24.2 107.3 0 83 0 53.6 0 24.3 24.2 0 53.8 0s53.8 24.3 53.8 53.6c0 29.4-24.2 53.7-53.8 53.7zM447.9 448h-92.4V302.4c0-34.7-12.4-58.4-43.3-58.4-23.6 0-37.6 15.8-43.8 31.1-2.3 5.5-2.8 13.1-2.8 20.7V448h-92.4s1.2-241.3 0-266.1h92.4v37.7c12.3-19 34.4-46.1 83.7-46.1 61.1 0 106.9 39.9 106.9 125.5V448z" />
                </svg>
                <span class="text-xs">LinkedIn</span>
            </a>

            <!-- WhatsApp -->
            <a href="https://wa.me/?text={{ request.build_absolute_uri }}" target="_blank" rel="noopener noreferrer"
                class="flex flex-col items-center space-y-1 text-center text-gray-600 dark:text-gray-300 hover:text-green-500 dark:hover:text-green-400">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 16 16">
                    <path
                        d="M13.601 2.326A7.85 7.85 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.9 7.9 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.9 7.9 0 0 0 13.6 2.326zM7.994 14.521a6.6 6.6 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.56 6.56 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592" />
                </svg>
                <span class="text-xs">WhatsApp</span>
            </a>

            <!-- Email -->
            <a href="mailto:?subject=Check this out&body={{ request.build_absolute_uri }}" target="_blank"
                class="flex flex-col items-center space-y-1 text-center text-gray-600 dark:text-gray-300 hover:text-blue-600 dark:hover:text-blue-400">
                <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24">
                    <path
                        d="M20 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z" />
                </svg>
                <span class="text-xs">Email</span>
            </a>
        </div>
    </div>

    <!-- Support Our Work Section -->
    <div class="mt-12 text-center">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Support Our Work</h2>
        <p class="text-gray-700 dark:text-gray-300 mb-6">
            Your contribution helps us continue providing valuable content. Choose your preferred currency to donate.
        </p>
        <div class="flex justify-center gap-4">
            <a href="" class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-2 px-4 rounded-full shadow">
                Donate in Naira
            </a>
            <a href="" class="bg-gray-200 hover:bg-gray-300 text-gray-800 font-semibold py-2 px-4 rounded-full shadow">
                Donate in Dollars
            </a>
        </div>
    </div>

    <!-- Related Posts Section -->
    <div class="mt-12 text-center">
        <h2 class="text-2xl font-bold text-gray-900 dark:text-white mb-2">Related Posts</h2>
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6 max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
            {% for related_post in related_posts %}
            <div class="bg-gray-100 dark:bg-gray-800 rounded-lg shadow-md p-4">
                <!-- Link the entire card to the related post detail page -->
                <a href="{% url 'post_detail' related_post.slug %}" class="block">
                    <!-- Image -->
                    <img src="{{ related_post.image.url }}" alt="{{ related_post.title }}"
                        class="w-full h-48 object-cover rounded-t-lg">
                    <!-- Title and Excerpt -->
                    <div class="p-4">
                        <h3 class="text-lg font-semibold text-gray-900 dark:text-white">{{ related_post.title }}</h3>
                        <p class="text-gray-600 dark:text-gray-400 mt-2">{{ related_post.excerpt }}</p>
                    </div>
                </a>
            </div>
            {% empty %}
            <p class="text-gray-600 dark:text-gray-400 mt-2">No related posts found.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}